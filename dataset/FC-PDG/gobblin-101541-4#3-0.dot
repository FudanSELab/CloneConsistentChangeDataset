digraph {
7 [style = filled, label = "createRandomRecord['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
50 [style = filled, label = "doNothing().when(reducerContext).write(any(),any())@@@45@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
28 [style = filled, label = "List<AvroValue<GenericRecord>> valueIterable = Lists.newArrayList(fullRecord1,fullRecord2,fullRecord3,fullRecord4)@@@46@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
70 [style = filled, label = "key.datum(keyRecord)@@@48@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
53 [style = filled, label = "reducer.setup(reducerContext)@@@44@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
16 [style = filled, label = "fullRecord3.datum(fullRecordBuilder1.build())@@@27@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
27 [style = filled, label = "when(reducerContext.getCounter(RecordKeyDedupReducerBase.EVENT_COUNTER.DEDUPED)).thenReturn(dedupedCounter)@@@41@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
45 [style = filled, label = "RecordKeyDedupReducerBase<AvroKey<GenericRecord>,AvroValue<GenericRecord>,AvroKey<GenericRecord>,NullWritable> reducer = new AvroKeyDedupReducer()@@@35@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
20 [style = filled, label = "AvroValue<GenericRecord> fullRecord2 = new AvroValue<>()@@@14@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
56 [style = filled, label = "fullRecord1.datum(fullRecordBuilder2.build())@@@63@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
37 [style = filled, label = "fullRecordBuilder1.set(\"scn2\",1000)@@@29@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
66 [style = filled, label = "fullRecordBuilder1.set(\"scn2\",1)@@@23@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
4 [style = filled, label = "GenericRecord record = keyRecordBuilder.build()@@@8@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
31 [style = filled, label = "fullRecordBuilder1.set(\"key\",record)@@@18@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
32 [style = filled, label = "AvroValue<GenericRecord> fullRecord4 = new AvroValue<>()@@@16@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
39 [style = filled, label = "Configuration conf2 = mock()@@@51@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
0 [style = filled, label = "keyRecordBuilder.set(\"environment\",\"test\")@@@5@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
13 [style = filled, label = "when(conf.get(AvroKeyDedupReducer.DELTA_SCHEMA_PROVIDER)).thenReturn(.getName())@@@32@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
35 [style = filled, label = "Schema keySchema = new Schema.Parser().parse(AVRO_KEY_SCHEMA)@@@3@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
62 [style = filled, label = "Counter recordCounter = new GenericCounter()@@@42@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
64 [style = filled, label = "fullRecordBuilder2.set(\"scn\",123)@@@61@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
29 [style = filled, label = "fullRecord3.datum(fullRecordBuilder2.build())@@@69@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
73 [style = filled, label = "fullRecordBuilder2.set(\"scn\",126)@@@67@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
75 [style = filled, label = "fullRecordBuilder1.set(\"scn\",123)@@@19@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
21 [style = filled, label = "when(reducerContext.getCounter(RecordKeyDedupReducerBase.EVENT_COUNTER.MORE_THAN_1)).thenReturn(moreThan1Counter)@@@39@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
8 [style = filled, label = "List<AvroValue<GenericRecord>> valueIterable2 = Lists.newArrayList(fullRecord1,fullRecord2,fullRecord3,fullRecord4)@@@73@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
51 [style = filled, label = "Counter dedupedCounter = new GenericCounter()@@@40@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
30 [style = filled, label = "keyRecordBuilder.set(\"key\",record)@@@10@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
63 [style = filled, label = "AvroKey<GenericRecord> key = new AvroKey<>()@@@47@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
22 [style = filled, label = "testAvroReduce['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
69 [style = filled, label = "keyRecordBuilder.set(\"partitionKey\",1)@@@5@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
34 [style = filled, label = "when(reducerContext.getCounter(RecordKeyDedupReducerBase.EVENT_COUNTER.RECORD_COUNT)).thenReturn(recordCounter)@@@43@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
42 [style = filled, label = "reducer2.setup(reducerContext)@@@55@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
78 [style = filled, label = "fullRecord2.datum(fullRecordBuilder2.build())@@@66@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
41 [style = filled, label = "fullRecordBuilder2.set(\"scn2\",100)@@@62@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
49 [style = filled, label = "fullRecordBuilder1.set(\"scn\",122)@@@28@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
54 [style = filled, label = "when(conf2.get(AvroKeyDedupReducer.DELTA_SCHEMA_PROVIDER)).thenReturn(null)@@@52@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
71 [style = filled, label = "Assert.assertEquals(reducer.getOutKey().datum(),fullRecord2.datum())@@@50@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
2 [style = filled, label = "GenericRecordBuilder keyRecordBuilder = new GenericRecordBuilder(getSchema())@@@3@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
43 [style = filled, label = "fullRecordBuilder2.set(\"scn2\",1000)@@@68@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
67 [style = filled, label = "Assert.assertEquals(reducer.getOutKey().datum(),fullRecord3.datum())@@@75@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
46 [style = filled, label = "fullRecord2.datum(fullRecordBuilder1.build())@@@24@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
17 [style = filled, label = "Assert.assertEquals(reducer2.getOutKey().datum(),fullRecord1.datum())@@@57@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
44 [style = filled, label = "Counter moreThan1Counter = new GenericCounter()@@@38@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
9 [style = filled, label = "fullRecordBuilder2.set(\"scn\",130)@@@70@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
1 [style = filled, label = "createRandomRecord['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
65 [style = filled, label = "when(reducerContext.getConfiguration()).thenReturn(conf)@@@37@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
18 [style = filled, label = "fullRecord4.datum(fullRecordBuilder1.build())@@@30@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
24 [style = filled, label = "keyRecordBuilder = new GenericRecordBuilder(keySchema)@@@9@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
5 [style = filled, label = "keyRecordBuilder.set(\"partitionKey\",new Long(1))@@@4@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
38 [style = filled, label = "fullRecordBuilder1.set(\"scn\",124)@@@25@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
57 [style = filled, label = "fullRecordBuilder2.set(\"scn\",125)@@@64@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
61 [style = filled, label = "fullRecordBuilder1.set(\"scn\",125)@@@22@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
76 [style = filled, label = "GenericRecord keyRecord = keyRecordBuilder.build()@@@11@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
15 [style = filled, label = "GenericRecordBuilder fullRecordBuilder1 = new GenericRecordBuilder(fullSchema)@@@17@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
11 [style = filled, label = "fullRecord4.datum(fullRecordBuilder2.build())@@@72@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
36 [style = filled, label = "reducer.reduce(key,valueIterable,reducerContext)@@@49@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
52 [style = filled, label = "fullRecordBuilder2.set(\"key\",record)@@@60@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
72 [style = filled, label = "reducer.reduce(key,valueIterable2,reducerContext)@@@74@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
26 [style = filled, label = "when(conf.get(FieldAttributeBasedDeltaFieldsProvider.DELTA_PROP_NAME,FieldAttributeBasedDeltaFieldsProvider.DEFAULT_DELTA_PROP_NAME)).thenReturn(FieldAttributeBasedDeltaFieldsProvider.DEFAULT_DELTA_PROP_NAME)@@@34@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
74 [style = filled, label = "GenericRecordBuilder keyRecordBuilder = new GenericRecordBuilder(keySchema.getField(\"key\").schema())@@@4@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
3 [style = filled, label = "keyRecordBuilder.set(\"subKey\",\"2\")@@@7@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
10 [style = filled, label = "reducer2.reduce(key,valueIterable,reducerContext)@@@56@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
19 [style = filled, label = "when(reducerContext.getConfiguration()).thenReturn(conf2)@@@53@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
58 [style = filled, label = "fullRecordBuilder2.set(\"scn2\",1000)@@@65@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
47 [style = filled, label = "GenericRecordBuilder fullRecordBuilder2 = new GenericRecordBuilder(fullSchema2)@@@59@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
48 [style = filled, label = "fullRecordBuilder2.set(\"scn2\",100)@@@71@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
14 [style = filled, label = "fullRecordBuilder1.set(\"scn2\",100)@@@20@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
55 [style = filled, label = "fullRecord1.datum(fullRecordBuilder1.build())@@@21@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
12 [style = filled, label = "AvroValue<GenericRecord> fullRecord1 = new AvroValue<>()@@@13@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
59 [style = filled, label = "when(conf.get(FieldAttributeBasedDeltaFieldsProvider.ATTRIBUTE_FIELD)).thenReturn(\"attributes_json\")@@@33@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
60 [style = filled, label = "AvroValue<GenericRecord> fullRecord3 = new AvroValue<>()@@@15@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
6 [style = filled, label = "keyRecordBuilder.set(\"environment\",\"test\")@@@6@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
40 [style = filled, label = "Schema fullSchema2 = new Schema.Parser().parse(AVRO_FULL_SCHEMA_WITH_TWO_DELTA_FIELDS)@@@58@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
25 [style = filled, label = "WrappedReducer.Context reducerContext = mock()@@@36@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
77 [style = filled, label = "RecordKeyDedupReducerBase<AvroKey<GenericRecord>,AvroValue<GenericRecord>,AvroKey<GenericRecord>,NullWritable> reducer2 = new AvroKeyDedupReducer()@@@54@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
33 [style = filled, label = "fullRecordBuilder1.set(\"scn2\",10)@@@26@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
23 [style = filled, label = "Configuration conf = mock()@@@31@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
68 [style = filled, label = "Schema fullSchema = new Schema.Parser().parse(AVRO_FULL_SCHEMA)@@@12@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
20->60 [style = bold, label=""];
64->41 [style = bold, label=""];
35->74 [style = bold, label=""];
44->21 [style = solid, label="moreThan1Counter"];
50->28 [style = bold, label=""];
4->30 [style = solid, label="record"];
12->28 [style = solid, label="fullRecord1"];
3->4 [style = solid, label="record"];
66->46 [style = bold, label=""];
22->35 [style = bold, label=""];
74->69 [style = bold, label=""];
52->64 [style = bold, label=""];
12->8 [style = solid, label="fullRecord1"];
4->24 [style = bold, label=""];
28->63 [style = bold, label=""];
46->38 [style = bold, label=""];
51->27 [style = bold, label=""];
31->75 [style = bold, label=""];
5->74 [style = dashed, label="0"];
21->51 [style = bold, label=""];
28->10 [style = solid, label="valueIterable"];
71->39 [style = bold, label=""];
55->61 [style = bold, label=""];
59->26 [style = bold, label=""];
1->2 [style = bold, label=""];
4->24 [style = dashed, label="0"];
42->10 [style = bold, label=""];
40->47 [style = bold, label=""];
10->17 [style = bold, label=""];
37->18 [style = bold, label=""];
60->28 [style = solid, label="fullRecord3"];
15->31 [style = bold, label=""];
43->29 [style = bold, label=""];
32->28 [style = solid, label="fullRecord4"];
65->44 [style = bold, label=""];
34->53 [style = bold, label=""];
76->68 [style = bold, label=""];
20->8 [style = solid, label="fullRecord2"];
68->12 [style = bold, label=""];
39->19 [style = solid, label="conf2"];
12->20 [style = bold, label=""];
26->45 [style = bold, label=""];
35->24 [style = solid, label="keySchema"];
49->37 [style = bold, label=""];
38->33 [style = bold, label=""];
27->62 [style = bold, label=""];
32->8 [style = solid, label="fullRecord4"];
20->28 [style = solid, label="fullRecord2"];
53->50 [style = bold, label=""];
51->27 [style = solid, label="dedupedCounter"];
4->52 [style = solid, label="record"];
7->2 [style = bold, label=""];
0->6 [style = bold, label=""];
25->42 [style = solid, label="reducerContext"];
25->10 [style = solid, label="reducerContext"];
54->19 [style = bold, label=""];
25->53 [style = solid, label="reducerContext"];
13->59 [style = bold, label=""];
76->70 [style = solid, label="keyRecord"];
63->70 [style = bold, label=""];
72->67 [style = bold, label=""];
8->72 [style = bold, label=""];
68->15 [style = solid, label="fullSchema"];
75->14 [style = bold, label=""];
60->32 [style = bold, label=""];
16->49 [style = bold, label=""];
23->13 [style = bold, label=""];
62->34 [style = bold, label=""];
47->52 [style = bold, label=""];
11->8 [style = bold, label=""];
70->36 [style = bold, label=""];
36->71 [style = bold, label=""];
6->3 [style = bold, label=""];
44->21 [style = bold, label=""];
28->36 [style = solid, label="valueIterable"];
30->76 [style = bold, label=""];
4->31 [style = solid, label="record"];
3->4 [style = bold, label=""];
57->58 [style = bold, label=""];
18->23 [style = bold, label=""];
69->6 [style = bold, label=""];
29->9 [style = bold, label=""];
14->55 [style = bold, label=""];
19->77 [style = bold, label=""];
23->65 [style = solid, label="conf"];
8->72 [style = solid, label="valueIterable2"];
25->65 [style = bold, label=""];
62->34 [style = solid, label="recordCounter"];
73->43 [style = bold, label=""];
63->36 [style = solid, label="key"];
63->72 [style = solid, label="key"];
2->5 [style = bold, label=""];
40->47 [style = solid, label="fullSchema2"];
9->48 [style = bold, label=""];
25->72 [style = solid, label="reducerContext"];
24->30 [style = bold, label=""];
33->16 [style = bold, label=""];
41->56 [style = bold, label=""];
56->57 [style = bold, label=""];
39->54 [style = bold, label=""];
5->0 [style = bold, label=""];
48->11 [style = bold, label=""];
58->78 [style = bold, label=""];
63->10 [style = solid, label="key"];
78->73 [style = bold, label=""];
60->8 [style = solid, label="fullRecord3"];
45->25 [style = bold, label=""];
32->15 [style = bold, label=""];
77->42 [style = bold, label=""];
17->40 [style = bold, label=""];
25->36 [style = solid, label="reducerContext"];
61->66 [style = bold, label=""];
}
