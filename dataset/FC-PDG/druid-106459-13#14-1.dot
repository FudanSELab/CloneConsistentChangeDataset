digraph {
13 [style = filled, label = "testGroupByTimeExtractionWithNulls['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
4 [style = filled, label = "Iterable<ResultRow> results = GroupByQueryRunnerTestHelper.runQuery(factory,runner,query)@@@6@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
12 [style = filled, label = "Iterable<ResultRow> results = GroupByQueryRunnerTestHelper.runQuery(factory,runner,query)@@@28@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
11 [style = filled, label = "TestHelper.assertExpectedObjects(expectedResults,results,\"time-extraction\")@@@29@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
6 [style = filled, label = "GroupByQuery query = makeQueryBuilder().setDataSource(QueryRunnerTestHelper.DATA_SOURCE).setQuerySegmentSpec(QueryRunnerTestHelper.FULL_ON_INTERVAL_SPEC).setDimensions(new DefaultDimensionSpec(\"market\",\"market\"),new ExtractionDimensionSpec(ColumnHolder.TIME_COLUMN_NAME,\"dayOfWeek\",new TimeFormatExtractionFn(\"EEEE\",null,null,null,false))).setAggregatorSpecs(QueryRunnerTestHelper.ROWS_COUNT,QueryRunnerTestHelper.INDEX_DOUBLE_SUM).setPostAggregatorSpecs(Collections.singletonList(QueryRunnerTestHelper.ADD_ROWS_INDEX_CONSTANT)).setGranularity(QueryRunnerTestHelper.ALL_GRAN).setDimFilter(new OrDimFilter(Arrays.asList(new SelectorDimFilter(\"market\",\"spot\",null),new SelectorDimFilter(\"market\",\"upfront\",null)))).build()@@@4@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
7 [style = filled, label = "testGroupByTimeExtraction['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
3 [style = filled, label = "cannotVectorize()@@@3@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
0 [style = filled, label = "GroupByQuery query = makeQueryBuilder().setDataSource(QueryRunnerTestHelper.dataSource).setQuerySegmentSpec(QueryRunnerTestHelper.fullOnIntervalSpec).setDimensions(new DefaultDimensionSpec(\"market\",\"market\"),new ExtractionDimensionSpec(ColumnHolder.TIME_COLUMN_NAME,\"dayOfWeek\",new TimeFormatExtractionFn(\"EEEE\",null,null,null,false))).setAggregatorSpecs(QueryRunnerTestHelper.rowsCount,QueryRunnerTestHelper.indexDoubleSum).setPostAggregatorSpecs(Collections.singletonList(QueryRunnerTestHelper.addRowsIndexConstant)).setGranularity(QueryRunnerTestHelper.allGran).setDimFilter(new OrDimFilter(Arrays.asList(new SelectorDimFilter(\"market\",\"spot\",null),new SelectorDimFilter(\"market\",\"upfront\",null)))).build()@@@4@@@['1', '0', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB1BBB"];
5 [style = filled, label = "List<ResultRow> expectedResults = Arrays.asList(makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Friday\",\"market\",\"spot\",\"index\",13219.574157714844,\"rows\",117L,\"addRowsIndexConstant\",13337.574157714844),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Monday\",\"market\",\"spot\",\"index\",13557.738830566406,\"rows\",117L,\"addRowsIndexConstant\",13675.738830566406),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Saturday\",\"market\",\"spot\",\"index\",13493.751281738281,\"rows\",117L,\"addRowsIndexConstant\",13611.751281738281),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Sunday\",\"market\",\"spot\",\"index\",13585.541015625,\"rows\",117L,\"addRowsIndexConstant\",13703.541015625),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Thursday\",\"market\",\"spot\",\"index\",14279.127197265625,\"rows\",126L,\"addRowsIndexConstant\",14406.127197265625),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Tuesday\",\"market\",\"spot\",\"index\",13199.471435546875,\"rows\",117L,\"addRowsIndexConstant\",13317.471435546875),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Wednesday\",\"market\",\"spot\",\"index\",14271.368591308594,\"rows\",126L,\"addRowsIndexConstant\",14398.368591308594),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Friday\",\"market\",\"upfront\",\"index\",27297.8623046875,\"rows\",26L,\"addRowsIndexConstant\",27324.8623046875),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Monday\",\"market\",\"upfront\",\"index\",27619.58447265625,\"rows\",26L,\"addRowsIndexConstant\",27646.58447265625),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Saturday\",\"market\",\"upfront\",\"index\",27820.83154296875,\"rows\",26L,\"addRowsIndexConstant\",27847.83154296875),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Sunday\",\"market\",\"upfront\",\"index\",24791.223876953125,\"rows\",26L,\"addRowsIndexConstant\",24818.223876953125),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Thursday\",\"market\",\"upfront\",\"index\",28562.748901367188,\"rows\",28L,\"addRowsIndexConstant\",28591.748901367188),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Tuesday\",\"market\",\"upfront\",\"index\",26968.280639648438,\"rows\",26L,\"addRowsIndexConstant\",26995.280639648438),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Wednesday\",\"market\",\"upfront\",\"index\",28985.5751953125,\"rows\",28L,\"addRowsIndexConstant\",29014.5751953125))@@@5@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
9 [style = filled, label = "final DimExtractionFn nullWednesdays = new DimExtractionFn(){@Override public String apply(String dimValue){if (\"Wednesday\".equals(dimValue)) {return null}{return dimValue}}@Override public byte(( getCacheKey(){throw new UnsupportedOperationException()}@Override public boolean preservesOrdering(){return false}@Override public ExtractionType getExtractionType(){return ExtractionType.MANY_TO_ONE}}@@@4@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
10 [style = filled, label = "GroupByQuery query = makeQueryBuilder().setDataSource(QueryRunnerTestHelper.dataSource).setQuerySegmentSpec(QueryRunnerTestHelper.fullOnIntervalSpec).setDimensions(new DefaultDimensionSpec(\"market\",\"market\"),new ExtractionDimensionSpec(ColumnHolder.TIME_COLUMN_NAME,\"dayOfWeek\",new CascadeExtractionFn(new ExtractionFn((((edu.fdu.CPPDG.tinypdg.pe.ExpressionInfo@8d091f))).setAggregatorSpecs(QueryRunnerTestHelper.rowsCount,QueryRunnerTestHelper.indexDoubleSum).setPostAggregatorSpecs(Collections.singletonList(QueryRunnerTestHelper.addRowsIndexConstant)).setGranularity(QueryRunnerTestHelper.allGran).setDimFilter(new OrDimFilter(Arrays.asList(new SelectorDimFilter(\"market\",\"spot\",null),new SelectorDimFilter(\"market\",\"upfront\",null)))).build()@@@24@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
1 [style = filled, label = "TestHelper.assertExpectedObjects(expectedResults,results,\"time-extraction\")@@@7@@@['1', '1', '0']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "List<ResultRow> expectedResults = Arrays.asList(makeRow(query,\"1970-01-01\",\"dayOfWeek\",null,\"market\",\"spot\",\"index\",14271.368591308594,\"rows\",126L,\"addRowsIndexConstant\",14398.368591308594),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Friday\",\"market\",\"spot\",\"index\",13219.574157714844,\"rows\",117L,\"addRowsIndexConstant\",13337.574157714844),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Monday\",\"market\",\"spot\",\"index\",13557.738830566406,\"rows\",117L,\"addRowsIndexConstant\",13675.738830566406),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Saturday\",\"market\",\"spot\",\"index\",13493.751281738281,\"rows\",117L,\"addRowsIndexConstant\",13611.751281738281),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Sunday\",\"market\",\"spot\",\"index\",13585.541015625,\"rows\",117L,\"addRowsIndexConstant\",13703.541015625),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Thursday\",\"market\",\"spot\",\"index\",14279.127197265625,\"rows\",126L,\"addRowsIndexConstant\",14406.127197265625),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Tuesday\",\"market\",\"spot\",\"index\",13199.471435546875,\"rows\",117L,\"addRowsIndexConstant\",13317.471435546875),makeRow(query,\"1970-01-01\",\"dayOfWeek\",null,\"market\",\"upfront\",\"index\",28985.5751953125,\"rows\",28L,\"addRowsIndexConstant\",29014.5751953125),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Friday\",\"market\",\"upfront\",\"index\",27297.8623046875,\"rows\",26L,\"addRowsIndexConstant\",27324.8623046875),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Monday\",\"market\",\"upfront\",\"index\",27619.58447265625,\"rows\",26L,\"addRowsIndexConstant\",27646.58447265625),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Saturday\",\"market\",\"upfront\",\"index\",27820.83154296875,\"rows\",26L,\"addRowsIndexConstant\",27847.83154296875),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Sunday\",\"market\",\"upfront\",\"index\",24791.223876953125,\"rows\",26L,\"addRowsIndexConstant\",24818.223876953125),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Thursday\",\"market\",\"upfront\",\"index\",28562.748901367188,\"rows\",28L,\"addRowsIndexConstant\",28591.748901367188),makeRow(query,\"1970-01-01\",\"dayOfWeek\",\"Tuesday\",\"market\",\"upfront\",\"index\",26968.280639648438,\"rows\",26L,\"addRowsIndexConstant\",26995.280639648438))@@@27@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
2 [style = filled, label = "testGroupByTimeExtraction['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
8->11 [style = solid, label="expectedResults"];
12->11 [style = solid, label="results"];
2->3 [style = bold, label=""];
0->6 [style = dashed, label="0"];
12->11 [style = bold, label=""];
0->4 [style = solid, label="query"];
3->6 [style = bold, label=""];
4->1 [style = solid, label="results"];
9->10 [style = bold, label=""];
0->5 [style = solid, label="query"];
6->5 [style = solid, label="query"];
7->3 [style = bold, label=""];
3->0 [style = bold, label=""];
3->9 [style = bold, label=""];
6->4 [style = solid, label="query"];
6->5 [style = bold, label=""];
5->1 [style = solid, label="expectedResults"];
10->8 [style = bold, label=""];
13->3 [style = bold, label=""];
5->4 [style = bold, label=""];
4->1 [style = bold, label=""];
10->8 [style = solid, label="query"];
8->12 [style = bold, label=""];
10->12 [style = solid, label="query"];
0->5 [style = bold, label=""];
}
