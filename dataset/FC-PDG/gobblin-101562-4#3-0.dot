digraph {
25 [style = filled, label = "this.retrierConfig = ConfigBuilder.create().loadProps(this.dataset.jobProps().getProperties(),COMPACTION_RETRY_PREFIX).build().withFallback(COMPACTION_RETRY_DEFAULTS)@@@42@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
16 [style = filled, label = "this.usePrimeReducers = this.dataset.jobProps().getPropAsBoolean(COMPACTION_JOB_USE_PRIME_REDUCERS,DEFAULT_COMPACTION_JOB_USE_PRIME_REDUCERS)@@@12@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
27 [style = filled, label = "MRCompactorJobRunner['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
28 [style = filled, label = "this.tmpFs = this.fs@@@22@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
34 [style = filled, label = "LOG.info(\"Retry disabled for compaction\")@@@47@@@['0', '1', '0']", fillcolor = lightgray, shape = ellipse image = "AAA1AAABBB2BBB"];
45 [style = filled, label = "this.condition = createRecompactionCondition()@@@6@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
11 [style = filled, label = "this.inputRecordCountProvider = (RecordCountProvider)Class.forName(this.dataset.jobProps().getProp(MRCompactor.COMPACTION_INPUT_RECORD_COUNT_PROVIDER,MRCompactor.DEFAULT_COMPACTION_INPUT_RECORD_COUNT_PROVIDER)).newInstance()@@@29@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
19 [style = filled, label = "this.outputRecordCountProvider = (RecordCountProvider)Class.forName(this.dataset.jobProps().getProp(MRCompactor.COMPACTION_OUTPUT_RECORD_COUNT_PROVIDER,MRCompactor.DEFAULT_COMPACTION_OUTPUT_RECORD_COUNT_PROVIDER)).newInstance()@@@30@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
23 [style = filled, label = "this.tmpFs = FileSystem.get(new URI(this.tmpFsUri),new Configuration())@@@19@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
2 [style = filled, label = "this.copyLateDataThreadPoolSize = this.dataset.jobProps().getPropAsInt(COMPACTION_COPY_LATE_DATA_THREAD_POOL_SIZE,DEFAULT_COMPACTION_COPY_LATE_DATA_THREAD_POOL_SIZE)@@@14@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
26 [style = filled, label = "FileSystem fs@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
7 [style = filled, label = "this.eventSubmitter = new EventSubmitter.Builder(GobblinMetrics.get(this.dataset.jobProps().getProp(ConfigurationKeys.JOB_NAME_KEY)).getMetricContext(),MRCompactor.COMPACTION_TRACKING_EVENTS_NAMESPACE).build()@@@13@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
17 [style = filled, label = "this.outputDeduplicated = this.dataset.jobProps().getPropAsBoolean(MRCompactor.COMPACTION_OUTPUT_DEDUPLICATED,MRCompactor.DEFAULT_COMPACTION_OUTPUT_DEDUPLICATED)@@@11@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
20 [style = filled, label = "this.recompactFromDestPaths = this.dataset.jobProps().getPropAsBoolean(MRCompactor.COMPACTION_RECOMPACT_FROM_DEST_PATHS,MRCompactor.DEFAULT_COMPACTION_RECOMPACT_FROM_DEST_PATHS)@@@6@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
24 [style = filled, label = "this.retrierConfig = WriterUtils.NO_RETRY_CONFIG@@@46@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
31 [style = filled, label = "Log.info(\"Tmp fs uri:\" + this.tmpFsUri)@@@17@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
32 [style = filled, label = "LOG.info(\"Retry enabled for compaction publish :\" + retrierConfig.root().render(ConfigRenderOptions.concise()))@@@43@@@['0', '1', '0']", fillcolor = lightgray, shape = ellipse image = "AAA1AAABBB2BBB"];
30 [style = filled, label = "throw new RuntimeException(\"Failed get Filesystem from tmp fs uri\",e)@@@26@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
6 [style = filled, label = "throw new RuntimeException(\"Failed to instantiate RecordCountProvider\",e)@@@36@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
22 [style = filled, label = "this.lateInputRecordCountProvider = new LateFileRecordCountProvider(this.inputRecordCountProvider)@@@31@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
36 [style = filled, label = "this.tmpFsUri != null@@@18@@@['0', '1', '0']", fillcolor = white, shape = diamond image = "AAA1AAABBB2BBB"];
47 [style = filled, label = "FileSystem fs@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
35 [style = filled, label = "this.isRetryEnabled@@@41@@@['0', '1', '0']", fillcolor = white, shape = diamond image = "AAA1AAABBB2BBB"];
15 [style = filled, label = "this.perm = HadoopUtils.deserializeFsPermission(this.dataset.jobProps(),COMPACTION_JOB_OUTPUT_DIR_PERMISSION,FsPermission.getDefault())@@@5@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
10 [style = filled, label = "this.recompactAllData = this.dataset.jobProps().getPropAsBoolean(MRCompactor.COMPACTION_RECOMPACT_ALL_DATA,MRCompactor.DEFAULT_COMPACTION_RECOMPACT_ALL_DATA)@@@7@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
4 [style = filled, label = "this.dataset = dataset@@@3@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
48 [style = filled, label = "this.dataset = dataset@@@5@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
39 [style = filled, label = "Dataset dataset@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
12 [style = filled, label = "Dataset dataset@@@2@@@['1', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
49 [style = filled, label = "this.outputRecordCountProvider = (RecordCountProvider)Class.forName(this.dataset.jobProps().getProp(MRCompactor.COMPACTION_OUTPUT_RECORD_COUNT_PROVIDER,MRCompactor.DEFAULT_COMPACTION_OUTPUT_RECORD_COUNT_PROVIDER)).newInstance()@@@9@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
14 [style = filled, label = "MRCompactorJobRunner['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
40 [style = filled, label = "Collection<String> extensions@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
37 [style = filled, label = "this.isRetryEnabled = this.dataset.jobProps().getPropAsBoolean(COMPACTION_RETRY_ENABLED,false)@@@33@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
46 [style = filled, label = "DatasetHelper['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
41 [style = filled, label = "this.extensions = extensions@@@3@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
43 [style = filled, label = "this.lateInputRecordCountProvider = new LateFileRecordCountProvider(this.inputRecordCountProvider)@@@10@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
1 [style = filled, label = "Preconditions.checkArgument(this.dataset.jobProps().contains(MRCompactor.COMPACTION_SHOULD_DEDUPLICATE),String.format(\"Missing property %s for dataset %s\",MRCompactor.COMPACTION_SHOULD_DEDUPLICATE,this.dataset))@@@9@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
44 [style = filled, label = "this.inputRecordCountProvider = (RecordCountProvider)Class.forName(this.dataset.jobProps().getProp(MRCompactor.COMPACTION_INPUT_RECORD_COUNT_PROVIDER,MRCompactor.DEFAULT_COMPACTION_INPUT_RECORD_COUNT_PROVIDER)).newInstance()@@@8@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
18 [style = filled, label = "this.datasetHelper = new DatasetHelper(this.dataset,this.fs,this.getApplicableFileExtensions())@@@39@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
21 [style = filled, label = "this.renameSourceDir = this.dataset.jobProps().getPropAsBoolean(MRCompactor.COMPACTION_RENAME_SOURCE_DIR_ENABLED,MRCompactor.DEFAULT_COMPACTION_RENAME_SOURCE_DIR_ENABLED)@@@8@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
33 [style = filled, label = "this.tmpFsUri = this.dataset.jobProps().getProp(COMPACTION_TMP_FS,null)@@@15@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
9 [style = filled, label = "this.applicablePathCache = CacheBuilder.newBuilder().maximumSize(2000).build()@@@38@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
0 [style = filled, label = "Dataset dataset@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
3 [style = filled, label = "Exception e@@@35@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "this.shouldDeduplicate = this.dataset.jobProps().getPropAsBoolean(MRCompactor.COMPACTION_SHOULD_DEDUPLICATE)@@@10@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
38 [style = filled, label = "this.outputExtension = this.dataset.jobProps().getProp(MRCompactor.COMPACTION_FILE_EXTENSION,\".avro\")@@@40@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
42 [style = filled, label = "this.lateOutputRecordCountProvider = new LateFileRecordCountProvider(this.outputRecordCountProvider)@@@11@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
29 [style = filled, label = "Exception e@@@25@@@['0', '1', '0']", fillcolor = white, shape = diamond image = "AAA1AAABBB2BBB"];
5 [style = filled, label = "this.lateOutputRecordCountProvider = new LateFileRecordCountProvider(this.outputRecordCountProvider)@@@32@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
13 [style = filled, label = "this.fs = fs@@@4@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
9->18 [style = bold, label=""];
29->30 [style = bold, label=""];
25->32 [style = bold, label=""];
46->40 [style = dotted, label="true"];
36->23 [style = dotted, label="true"];
14->0 [style = dotted, label="true"];
46->39 [style = dotted, label="true"];
13->15 [style = bold, label=""];
10->21 [style = bold, label=""];
22->5 [style = bold, label=""];
33->31 [style = bold, label=""];
24->34 [style = bold, label=""];
45->44 [style = bold, label=""];
19->5 [style = solid, label="outputRecordCountProvider"];
20->10 [style = bold, label=""];
13->48 [style = bold, label=""];
39->48 [style = solid, label="dataset"];
27->4 [style = bold, label=""];
2->11 [style = bold, label=""];
1->8 [style = bold, label=""];
30->11 [style = bold, label=""];
19->22 [style = bold, label=""];
41->13 [style = bold, label=""];
33->36 [style = solid, label="tmpFsUri"];
47->13 [style = solid, label="fs"];
23->11 [style = bold, label=""];
49->43 [style = bold, label=""];
35->32 [style = dotted, label="true"];
5->9 [style = bold, label=""];
8->17 [style = bold, label=""];
27->12 [style = dotted, label="true"];
27->26 [style = dotted, label="true"];
12->4 [style = solid, label="dataset"];
14->12 [style = dotted, label="true"];
33->23 [style = solid, label="tmpFsUri"];
40->41 [style = solid, label="extensions"];
0->4 [style = solid, label="dataset"];
36->23 [style = bold, label=""];
43->42 [style = bold, label=""];
3->6 [style = bold, label=""];
6->9 [style = bold, label=""];
5->37 [style = bold, label=""];
46->47 [style = dotted, label="true"];
12->47 [style = dashed, label="0"];
4->41 [style = dashed, label="0"];
11->22 [style = solid, label="inputRecordCountProvider"];
35->25 [style = dotted, label="true"];
48->45 [style = bold, label=""];
36->28 [style = dotted, label="false"];
12->13 [style = solid, label="fs"];
11->19 [style = bold, label=""];
13->18 [style = solid, label="fs"];
33->31 [style = solid, label="tmpFsUri"];
18->38 [style = bold, label=""];
44->49 [style = bold, label=""];
36->28 [style = bold, label=""];
3->6 [style = dotted, label="true"];
2->33 [style = bold, label=""];
38->35 [style = bold, label=""];
29->30 [style = dotted, label="true"];
35->24 [style = dotted, label="false"];
15->20 [style = bold, label=""];
35->34 [style = dotted, label="false"];
35->25 [style = bold, label=""];
13->28 [style = solid, label="fs"];
4->1 [style = solid, label="dataset"];
37->35 [style = solid, label="isRetryEnabled"];
4->13 [style = bold, label=""];
21->1 [style = bold, label=""];
16->7 [style = bold, label=""];
31->36 [style = bold, label=""];
44->43 [style = solid, label="inputRecordCountProvider"];
14->4 [style = bold, label=""];
28->11 [style = bold, label=""];
4->18 [style = solid, label="dataset"];
46->41 [style = bold, label=""];
35->24 [style = bold, label=""];
37->9 [style = bold, label=""];
17->16 [style = bold, label=""];
26->13 [style = solid, label="fs"];
49->42 [style = solid, label="outputRecordCountProvider"];
7->2 [style = bold, label=""];
}
