digraph {
15 [style = filled, label = "final VolumeVO parentVolume@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
22 [style = filled, label = "final Long maxIops@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
19 [style = filled, label = "final Account caller@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
1 [style = filled, label = "final Long size@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
5 [style = filled, label = "final Account owner@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
23 [style = filled, label = "final String uuid@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
24 [style = filled, label = "final Long size@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
7 [style = filled, label = "final CreateVolumeCmd cmd@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
30 [style = filled, label = "Boolean displayVolume@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
35 [style = filled, label = "updateResourceCount['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
17 [style = filled, label = "final Long minIops@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
9 [style = filled, label = "final Long diskOfferingId@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "final VolumeVO parentVolume@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
26 [style = filled, label = "final Long diskOfferingId@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
20 [style = filled, label = "final CreateVolumeCmd cmd@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
13 [style = filled, label = "commitVolume['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
29 [style = filled, label = "final String userSpecifiedName@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA1AAABBB2BBB"];
10 [style = filled, label = "final Long zoneId@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
18 [style = filled, label = "commitVolume['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
6 [style = filled, label = "final String uuid@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
3 [style = filled, label = "final String userSpecifiedName@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
16 [style = filled, label = "final Boolean displayVolume@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
0 [style = filled, label = "final Storage.ProvisioningType provisioningType@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
11 [style = filled, label = "final Long minIops@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
12 [style = filled, label = "final Boolean displayVolume@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA1AAABBB1BBB"];
25 [style = filled, label = "final Long zoneId@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
27 [style = filled, label = "final Map<String,String> details@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
32 [style = filled, label = "_resourceLimitMgr.changeResourceCount(volume.getAccountId(),ResourceType.primary_storage,displayVolume,new Long(volume.getSize()))@@@5@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
28 [style = filled, label = "final Storage.ProvisioningType provisioningType@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
14 [style = filled, label = "return Transaction.execute(new TransactionCallback<VolumeVO>(){@Override public VolumeVO doInTransaction(TransactionStatus status){VolumeVO volume = new VolumeVO(userSpecifiedName,-1,-1,-1,-1,new Long(-1),null,null,provisioningType,0,Volume.Type.DATADISK)volume.setPoolId(null)volume.setUuid(uuid)volume.setDataCenterId(zoneId)volume.setPodId(null)volume.setAccountId(owner.getId())volume.setDomainId(owner.getDomainId())volume.setDiskOfferingId(diskOfferingId)volume.setSize(size)volume.setMinIops(minIops)volume.setMaxIops(maxIops)volume.setInstanceId(null)volume.setUpdated(new Date())volume.setDisplayVolume(displayVolume)if (parentVolume != null) {volume.setTemplateId(parentVolume.getTemplateId())volume.setFormat(parentVolume.getFormat())}{volume.setTemplateId(null)}volume = _volsDao.persist(volume)if (cmd.getSnapshotId() == null && displayVolume) {UsageEventUtils.publishUsageEvent(EventTypes.EVENT_VOLUME_CREATE,volume.getAccountId(),volume.getDataCenterId(),volume.getId(),volume.getName(),diskOfferingId,null,size,.getName(),volume.getUuid(),displayVolume)}if (volume != null && details != null) {List<VolumeDetailVO> volumeDetailsVO = new ArrayList<VolumeDetailVO>()if (details.containsKey(Volume.BANDWIDTH_LIMIT_IN_MBPS)) {volumeDetailsVO.add(new VolumeDetailVO(volume.getId(),Volume.BANDWIDTH_LIMIT_IN_MBPS,details.get(Volume.BANDWIDTH_LIMIT_IN_MBPS),false))}if (details.containsKey(Volume.IOPS_LIMIT)) {volumeDetailsVO.add(new VolumeDetailVO(volume.getId(),Volume.IOPS_LIMIT,details.get(Volume.IOPS_LIMIT),false))}if (!volumeDetailsVO.isEmpty()) {_volsDetailsDao.saveDetails(volumeDetailsVO)}}CallContext.current().setEventDetails(\"Volume Id: \" + volume.getUuid())_resourceLimitMgr.incrementResourceCount(volume.getAccountId(),ResourceType.volume,displayVolume)_resourceLimitMgr.incrementResourceCount(volume.getAccountId(),ResourceType.primary_storage,displayVolume,new Long(volume.getSize()))return volume}})@@@3@@@['1', '1', '0']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB1BBB"];
21 [style = filled, label = "final Account owner@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
4 [style = filled, label = "final Account caller@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
31 [style = filled, label = "displayVolume != null && displayVolume != volume.isDisplayVolume()@@@3@@@['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
34 [style = filled, label = "Volume volume@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
33 [style = filled, label = "_resourceLimitMgr.changeResourceCount(volume.getAccountId(),ResourceType.volume,displayVolume)@@@4@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
2 [style = filled, label = "final Long maxIops@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
13->6 [style = dotted, label="true"];
35->31 [style = bold, label=""];
26->14 [style = solid, label="diskOfferingId"];
8->14 [style = solid, label="parentVolume"];
9->14 [style = solid, label="diskOfferingId"];
28->14 [style = solid, label="provisioningType"];
18->25 [style = dotted, label="true"];
13->3 [style = dotted, label="true"];
6->14 [style = solid, label="uuid"];
13->12 [style = dotted, label="true"];
18->16 [style = dotted, label="true"];
18->24 [style = dotted, label="true"];
18->19 [style = dotted, label="true"];
18->21 [style = dotted, label="true"];
18->15 [style = dotted, label="true"];
13->5 [style = dotted, label="true"];
15->14 [style = solid, label="parentVolume"];
24->14 [style = solid, label="size"];
13->7 [style = dotted, label="true"];
18->20 [style = dotted, label="true"];
18->23 [style = dotted, label="true"];
13->10 [style = dotted, label="true"];
31->33 [style = dotted, label="true"];
35->30 [style = dotted, label="true"];
1->14 [style = solid, label="size"];
25->14 [style = solid, label="zoneId"];
31->32 [style = dotted, label="true"];
13->2 [style = dotted, label="true"];
30->32 [style = solid, label="displayVolume"];
13->1 [style = dotted, label="true"];
23->14 [style = solid, label="uuid"];
13->0 [style = dotted, label="true"];
13->8 [style = dotted, label="true"];
18->26 [style = dotted, label="true"];
18->28 [style = dotted, label="true"];
31->33 [style = bold, label=""];
22->14 [style = solid, label="maxIops"];
0->14 [style = solid, label="provisioningType"];
12->29 [style = dashed, label="0"];
35->34 [style = dotted, label="true"];
13->11 [style = dotted, label="true"];
33->32 [style = bold, label=""];
2->14 [style = solid, label="maxIops"];
18->22 [style = dotted, label="true"];
17->14 [style = solid, label="minIops"];
18->17 [style = dotted, label="true"];
12->14 [style = solid, label="displayVolume"];
10->14 [style = solid, label="zoneId"];
11->14 [style = solid, label="minIops"];
18->29 [style = dotted, label="true"];
30->31 [style = solid, label="displayVolume"];
30->33 [style = solid, label="displayVolume"];
27->14 [style = solid, label="details"];
29->14 [style = solid, label="userSpecifiedName"];
13->14 [style = bold, label=""];
3->14 [style = solid, label="userSpecifiedName"];
18->27 [style = dotted, label="true"];
18->14 [style = bold, label=""];
13->4 [style = dotted, label="true"];
16->14 [style = solid, label="displayVolume"];
34->33 [style = solid, label="volume"];
13->9 [style = dotted, label="true"];
}
