digraph {
21 [style = filled, label = "++i@@@11@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
32 [style = filled, label = "mockLoginContext.login()@@@12@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
41 [style = filled, label = "long absoluteLastRefreshMs = startMs + (1 + numExpectedRefreshes) * 1000 * 60 * refreshEveryMinutes - 1000 * 60 * refreshEveryMinutes / 2@@@12@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
17 [style = filled, label = "testExpiringCredentialRefreshingLogin.login()@@@32@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "mockLoginContext.logout()@@@13@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
46 [style = filled, label = "inOrder.verify(mockLoginContext).logout()@@@42@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
38 [style = filled, label = "assertTrue(testLoginContextFactory.refresherThreadStartedFuture().isDone())@@@25@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
18 [style = filled, label = "boolean clientReloginAllowedBeforeLogout = true@@@4@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
57 [style = filled, label = "long expectedFinalMs = startMs + numExpectedRefreshes * 1000 * (60 * refreshEveryMinutes - bufferIntrusionSeconds)@@@29@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
56 [style = filled, label = "short minPeriodSeconds = (short)0@@@23@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
19 [style = filled, label = "final LoginContext mockLoginContext = EasyMock.strictMock()@@@6@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
6 [style = filled, label = "MockTime mockTime = new MockTime()@@@16@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
13 [style = filled, label = "assertTrue(waiter.isDone())@@@40@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
4 [style = filled, label = "assertTrue(testLoginContextFactory.refresherThreadStartedFuture().isDone())@@@33@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
16 [style = filled, label = "long absoluteLastRefreshMs = startMs + (1 + numExpectedRefreshes) * 1000 * 60 * refreshEveryMinutes - 1000 * 60 * refreshEveryMinutes / 2@@@20@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
31 [style = filled, label = "i < numExpectedRefreshes@@@29@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
12 [style = filled, label = "long startMs = mockTime.milliseconds()@@@17@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
52 [style = filled, label = "testRefreshWithPreExpirationBufferIntrusion['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
0 [style = filled, label = "assertFalse(testLoginContextFactory.refresherThreadDoneFuture().isDone())@@@31@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
39 [style = filled, label = "mockLoginContext.login()@@@7@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
48 [style = filled, label = "short bufferSeconds = (short)0@@@15@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
55 [style = filled, label = "short bufferSeconds = (short)((lifetimeMinutes - refreshEveryMinutes) * 60 + bufferIntrusionSeconds)@@@22@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
37 [style = filled, label = "EasyMock.replay(mockLoginContext)@@@15@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
9 [style = filled, label = "TestLoginContextFactory testLoginContextFactory = new TestLoginContextFactory()@@@26@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
10 [style = filled, label = "assertFalse(waiters.get(numExpectedRefreshes).isDone())@@@43@@@['1', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB1BBB"];
30 [style = filled, label = "i < numExpectedRefreshes@@@37@@@['1', '1', '1']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
3 [style = filled, label = "assertEquals(expectedFinalMs,mockTime.milliseconds())@@@35@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
34 [style = filled, label = "TestExpiringCredentialRefreshingLogin testExpiringCredentialRefreshingLogin = new TestExpiringCredentialRefreshingLogin(refreshConfigThatPerformsReloginEveryGivenPercentageOfLifetime(1.0 * refreshEveryMinutes / lifetimeMinutes,minPeriodSeconds,bufferSeconds,clientReloginAllowedBeforeLogout),testLoginContextFactory,mockTime,1000 * 60 * lifetimeMinutes,absoluteLastRefreshMs,clientReloginAllowedBeforeLogout)@@@27@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
29 [style = filled, label = "int bufferIntrusionSeconds = 1@@@21@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
7 [style = filled, label = "long refreshEveryMinutes = 8L@@@19@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
15 [style = filled, label = "inOrder.verify(mockLoginContext).login()@@@41@@@['1', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB1BBB"];
28 [style = filled, label = "long lifetimeMinutes = 10L@@@18@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
42 [style = filled, label = "int bufferIntrusionSeconds = 1@@@13@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
5 [style = filled, label = "++i@@@38@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
43 [style = filled, label = "MockTime mockTime = new MockTime()@@@8@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
54 [style = filled, label = "assertEquals((i + 1) * 1000 * (60 * refreshEveryMinutes - bufferIntrusionSeconds),waiter.get().longValue() - startMs)@@@41@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
50 [style = filled, label = "when(mockLoginContext.getSubject()).thenReturn(subject)@@@7@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
24 [style = filled, label = "testLoginContextFactory.refresherThreadDoneFuture().get(1L,TimeUnit.SECONDS)@@@34@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
11 [style = filled, label = "Subject subject = new Subject()@@@5@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
53 [style = filled, label = "List<KafkaFutureImpl<Long>> waiters = addWaiters(mockScheduler,1000 * (60 * refreshEveryMinutes - bufferIntrusionSeconds),numExpectedRefreshes + 1)@@@25@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
47 [style = filled, label = "long startMs = mockTime.milliseconds()@@@9@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
44 [style = filled, label = "short minPeriodSeconds = (short)(refreshEveryMinutes * 60 + bufferIntrusionSeconds)@@@14@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
1 [style = filled, label = "int numExpectedRefreshes = 1@@@3@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
36 [style = filled, label = "int i = 0@@@9@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
51 [style = filled, label = "testRefreshWithMinPeriodIntrusion['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
35 [style = filled, label = "int i = 0@@@36@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
40 [style = filled, label = "final LoginContext mockLoginContext = mock()@@@6@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
14 [style = filled, label = "testRefreshWithMinPeriodIntrusion['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
49 [style = filled, label = "long lifetimeMinutes = 10L@@@10@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
22 [style = filled, label = "assertFalse(testLoginContextFactory.refresherThreadStartedFuture().isDone())@@@22@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
33 [style = filled, label = "assertFalse(testLoginContextFactory.refresherThreadStartedFuture().isDone())@@@30@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
45 [style = filled, label = "long refreshEveryMinutes = 8L@@@11@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB2BBB"];
26 [style = filled, label = "KafkaFutureImpl<Long> waiter = waiters.get(i)@@@39@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
2 [style = filled, label = "i < numExpectedRefreshes@@@10@@@['1', '0', '1']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
20 [style = filled, label = "assertFalse(testLoginContextFactory.refresherThreadDoneFuture().isDone())@@@23@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
25 [style = filled, label = "testLoginContextFactory.configure(mockLoginContext,testExpiringCredentialRefreshingLogin)@@@28@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
27 [style = filled, label = "MockScheduler mockScheduler = new MockScheduler(mockTime)@@@24@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
23 [style = filled, label = "EasyMock.expect(mockLoginContext.getSubject()).andReturn(subject)@@@8@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
7->55 [style = solid, label="refreshEveryMinutes"];
52->1 [style = bold, label=""];
42->12 [style = solid, label="bufferIntrusionSeconds"];
9->34 [style = solid, label="testLoginContextFactory"];
30->5 [style = dotted, label="true"];
7->31 [style = solid, label="refreshEveryMinutes"];
27->38 [style = bold, label=""];
46->13 [style = bold, label=""];
20->56 [style = dashed, label="0"];
57->33 [style = bold, label=""];
15->54 [style = dashed, label="0"];
56->27 [style = bold, label=""];
7->22 [style = solid, label="refreshEveryMinutes"];
47->41 [style = solid, label="startMs"];
51->1 [style = bold, label=""];
7->16 [style = solid, label="testExpiringCredentialRefreshingLogin"];
26->13 [style = dotted, label="true"];
45->4 [style = solid, label="refreshEveryMinutes"];
48->7 [style = solid, label="bufferSeconds"];
21->2 [style = bold, label=""];
20->27 [style = bold, label=""];
25->31 [style = bold, label=""];
3->35 [style = bold, label=""];
33->0 [style = bold, label=""];
47->49 [style = bold, label=""];
12->15 [style = solid, label="startMs"];
44->7 [style = solid, label="minPeriodSeconds"];
1->53 [style = solid, label="numExpectedRefreshes"];
29->57 [style = solid, label="bufferIntrusionSeconds"];
55->34 [style = solid, label="bufferSeconds"];
42->44 [style = bold, label=""];
16->34 [style = solid, label="absoluteLastRefreshMs"];
45->44 [style = solid, label="refreshEveryMinutes"];
22->55 [style = dashed, label="0"];
6->27 [style = solid, label="mockTime"];
36->2 [style = bold, label=""];
39->23 [style = bold, label=""];
27->53 [style = solid, label="mockScheduler"];
7->16 [style = bold, label=""];
26->15 [style = bold, label=""];
12->54 [style = solid, label="startMs"];
39->50 [style = dashed, label="0"];
1->41 [style = solid, label="numExpectedRefreshes"];
23->36 [style = bold, label=""];
29->54 [style = solid, label="bufferIntrusionSeconds"];
2->32 [style = bold, label=""];
5->30 [style = bold, label=""];
22->34 [style = solid, label="minPeriodSeconds"];
54->5 [style = bold, label=""];
45->7 [style = solid, label="refreshEveryMinutes"];
2->8 [style = dotted, label="true"];
25->57 [style = bold, label=""];
1->12 [style = solid, label="numExpectedRefreshes"];
42->4 [style = solid, label="bufferIntrusionSeconds"];
45->41 [style = bold, label=""];
1->38 [style = solid, label="numExpectedRefreshes"];
28->55 [style = solid, label="lifetimeMinutes"];
40->50 [style = bold, label=""];
28->7 [style = solid, label="testLoginContextFactory"];
50->43 [style = bold, label=""];
35->30 [style = solid, label="i"];
12->28 [style = bold, label=""];
0->17 [style = bold, label=""];
31->57 [style = dashed, label="0"];
27->53 [style = bold, label=""];
16->29 [style = bold, label=""];
18->11 [style = bold, label=""];
30->26 [style = bold, label=""];
29->38 [style = solid, label="bufferIntrusionSeconds"];
1->16 [style = solid, label="numExpectedRefreshes"];
29->15 [style = solid, label="bufferIntrusionSeconds"];
19->39 [style = bold, label=""];
49->7 [style = solid, label="lifetimeMinutes"];
7->54 [style = solid, label="refreshEveryMinutes"];
29->34 [style = solid, label="expectedFinalMs"];
45->12 [style = solid, label="refreshEveryMinutes"];
2->21 [style = dotted, label="true"];
31->33 [style = dotted, label="true"];
12->57 [style = solid, label="startMs"];
26->13 [style = bold, label=""];
19->37 [style = solid, label="mockLoginContext"];
7->38 [style = solid, label="refreshEveryMinutes"];
30->54 [style = dotted, label="true"];
1->26 [style = solid, label="numExpectedRefreshes"];
40->35 [style = solid, label="mockLoginContext"];
43->47 [style = bold, label=""];
11->23 [style = solid, label="subject"];
22->20 [style = bold, label=""];
1->2 [style = solid, label="numExpectedRefreshes"];
31->33 [style = bold, label=""];
31->17 [style = dotted, label="true"];
29->22 [style = solid, label="bufferIntrusionSeconds"];
30->10 [style = bold, label=""];
13->15 [style = bold, label=""];
31->3 [style = bold, label=""];
24->3 [style = bold, label=""];
36->2 [style = solid, label="i"];
49->45 [style = bold, label=""];
18->7 [style = solid, label="clientReloginAllowedBeforeLogout"];
26->46 [style = dotted, label="true"];
25->4 [style = solid, label="i"];
4->24 [style = bold, label=""];
31->0 [style = bold, label=""];
1->30 [style = solid, label="numExpectedRefreshes"];
56->34 [style = solid, label="minPeriodSeconds"];
13->54 [style = bold, label=""];
57->3 [style = solid, label="expectedFinalMs"];
38->9 [style = bold, label=""];
5->26 [style = bold, label=""];
19->25 [style = solid, label="mockLoginContext"];
42->44 [style = solid, label="bufferIntrusionSeconds"];
47->4 [style = solid, label="startMs"];
25->31 [style = solid, label="i"];
4->33 [style = bold, label=""];
48->6 [style = bold, label=""];
31->0 [style = dotted, label="true"];
31->3 [style = solid, label="expectedFinalMs"];
29->55 [style = bold, label=""];
32->8 [style = bold, label=""];
30->13 [style = dotted, label="true"];
30->5 [style = bold, label=""];
13->26 [style = bold, label=""];
43->7 [style = solid, label="mockTime"];
35->54 [style = solid, label="i"];
7->34 [style = solid, label="refreshEveryMinutes"];
38->53 [style = dashed, label="0"];
26->15 [style = dotted, label="true"];
43->6 [style = solid, label="mockTime"];
34->25 [style = solid, label="testExpiringCredentialRefreshingLogin"];
53->9 [style = bold, label=""];
41->7 [style = solid, label="absoluteLastRefreshMs"];
35->30 [style = bold, label=""];
42->29 [style = solid, label="bufferIntrusionSeconds"];
19->40 [style = dashed, label="0"];
17->4 [style = bold, label=""];
12->31 [style = solid, label="startMs"];
5->26 [style = solid, label="i"];
6->12 [style = bold, label=""];
12->16 [style = solid, label="startMs"];
1->57 [style = solid, label="numExpectedRefreshes"];
7->15 [style = solid, label="refreshEveryMinutes"];
34->25 [style = bold, label=""];
45->29 [style = solid, label="refreshEveryMinutes"];
7->57 [style = solid, label="refreshEveryMinutes"];
25->0 [style = solid, label="i"];
7->53 [style = solid, label="refreshEveryMinutes"];
29->55 [style = solid, label="bufferIntrusionSeconds"];
28->7 [style = bold, label=""];
1->18 [style = bold, label=""];
35->15 [style = solid, label="i"];
30->26 [style = dotted, label="true"];
11->19 [style = bold, label=""];
37->6 [style = bold, label=""];
11->40 [style = bold, label=""];
35->26 [style = solid, label="i"];
45->41 [style = solid, label="refreshEveryMinutes"];
15->5 [style = bold, label=""];
14->1 [style = bold, label=""];
55->56 [style = bold, label=""];
7->16 [style = solid, label="refreshEveryMinutes"];
2->32 [style = dotted, label="true"];
20->34 [style = solid, label="bufferSeconds"];
11->50 [style = solid, label="subject"];
29->53 [style = solid, label="bufferIntrusionSeconds"];
29->31 [style = solid, label="bufferIntrusionSeconds"];
1->29 [style = solid, label="numExpectedRefreshes"];
44->48 [style = bold, label=""];
18->34 [style = solid, label="clientReloginAllowedBeforeLogout"];
8->21 [style = bold, label=""];
33->31 [style = bold, label=""];
15->46 [style = bold, label=""];
6->12 [style = solid, label="mockScheduler"];
28->34 [style = solid, label="lifetimeMinutes"];
47->29 [style = solid, label="startMs"];
6->34 [style = solid, label="mockTime"];
1->31 [style = solid, label="numExpectedRefreshes"];
29->22 [style = bold, label=""];
27->38 [style = solid, label="mockScheduler"];
2->37 [style = bold, label=""];
30->15 [style = dotted, label="true"];
31->4 [style = dotted, label="true"];
40->16 [style = solid, label="mockLoginContext"];
41->42 [style = bold, label=""];
9->34 [style = bold, label=""];
}
