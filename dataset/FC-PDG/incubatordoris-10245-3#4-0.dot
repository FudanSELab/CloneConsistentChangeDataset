digraph {
11 [style = filled, label = "Map<Integer,Long> oldKafkaProgressMap = Maps.newHashMap()@@@24@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
39 [style = filled, label = "routineLoadTaskInfoList.add(routineLoadTaskInfo)@@@17@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
38 [style = filled, label = "Deencapsulation.setField(routineLoadJob,\"progress\",oldkafkaProgress)@@@28@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
12 [style = filled, label = "KafkaRoutineLoadJob routineLoadJob = new KafkaRoutineLoadJob(1L,\"test\",\"default_cluster\",1L,1L,\"host:port\",\"topic\")@@@11@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
55 [style = filled, label = "Assert.assertEquals(RoutineLoadJob.JobState.PAUSED,routineLoadJob.getState())@@@49@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
16 [style = filled, label = "@Injectable TabletCommitInfo tabletCommitInfo@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
18 [style = filled, label = "rlTaskTxnCommitAttachment.setJobId(Deencapsulation.getField(routineLoadJob,\"id\"))@@@34@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
43 [style = filled, label = "kafkaProgress.put(1,10L)@@@38@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
36 [style = filled, label = "transTablets.add(tabletCommitInfo3)@@@10@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
15 [style = filled, label = "rlTaskTxnCommitAttachment.setLoadSourceType(TLoadSourceType.KAFKA)@@@35@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
20 [style = filled, label = "rlTaskTxnCommitAttachment.setId(new TUniqueId())@@@31@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
34 [style = filled, label = "Map<Integer,Long> kafkaProgress = Maps.newHashMap()@@@37@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
31 [style = filled, label = "Deencapsulation.setField(oldkafkaProgress,\"partitionIdToOffset\",oldKafkaProgressMap)@@@27@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
27 [style = filled, label = "TransactionState transactionState = new TransactionState(1L,Lists.newArrayList(1L),1L,\"label\",null,LoadJobSourceType.ROUTINE_LOAD_TASK,new TxnCoordinator(TxnSourceType.BE,\"be1\"),routineLoadJob.getId(),Config.stream_load_default_timeout_second)@@@18@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
10 [style = filled, label = "TabletCommitInfo tabletCommitInfo3 = new TabletCommitInfo(CatalogTestUtil.testTabletId1,CatalogTestUtil.testBackendId3)@@@6@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
41 [style = filled, label = "FakeCatalog.setCatalog(masterCatalog)@@@3@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
26 [style = filled, label = "TabletCommitInfo tabletCommitInfo1 = new TabletCommitInfo(CatalogTestUtil.testTabletId1,CatalogTestUtil.testBackendId1)@@@4@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "transTablets.add(tabletCommitInfo2)@@@9@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
25 [style = filled, label = "KafkaProgress oldkafkaProgress = new KafkaProgress()@@@26@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
44 [style = filled, label = "transTablets.add(tabletCommitInfo1)@@@8@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
7 [style = filled, label = "masterTransMgr.getCallbackFactory().addCallback(routineLoadJob)@@@20@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
47 [style = filled, label = "RoutineLoadManager routineLoadManager = new RoutineLoadManager()@@@42@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
37 [style = filled, label = "@Injectable TabletCommitInfo tabletCommitInfo@@@2@@@['1', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
52 [style = filled, label = "@Mocked KafkaConsumer kafkaConsumer@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
53 [style = filled, label = "testCommitRoutineLoadTransaction['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
58 [style = filled, label = "Assert.assertEquals(Long.valueOf(0),Deencapsulation.getField(routineLoadJob,\"currentTotalRows\"))@@@46@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
30 [style = filled, label = "rlTaskTxnCommitAttachment.setLoadedRows(100)@@@32@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
51 [style = filled, label = "@Mocked EditLog editLog@@@2@@@['0', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB2BBB"];
17 [style = filled, label = "@Mocked KafkaConsumer kafkaConsumer@@@2@@@['1', '0', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
4 [style = filled, label = "TxnCommitAttachment txnCommitAttachment = new RLTaskTxnCommitAttachment(rlTaskTxnCommitAttachment)@@@41@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
49 [style = filled, label = "partitionIdToOffset.put(1,0L)@@@14@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
2 [style = filled, label = "routineLoadManager.addRoutineLoadJob(routineLoadJob,\"db\")@@@43@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
0 [style = filled, label = "Deencapsulation.setField(masterTransMgr.getDatabaseTransactionMgr(CatalogTestUtil.testDbId1),\"idToRunningTransactionState\",idToTransactionState)@@@44@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
1 [style = filled, label = "Map<Long,TransactionState> idToTransactionState = Maps.newHashMap()@@@21@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
9 [style = filled, label = "TRLTaskTxnCommitAttachment rlTaskTxnCommitAttachment = new TRLTaskTxnCommitAttachment()@@@30@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
14 [style = filled, label = "KafkaTaskInfo routineLoadTaskInfo = new KafkaTaskInfo(UUID.randomUUID(),1L,\"defualt_cluster\",20000,partitionIdToOffset)@@@15@@@['1', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
21 [style = filled, label = "masterTransMgr.commitTransaction(1L,1L,transTablets,txnCommitAttachment)@@@45@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
57 [style = filled, label = "@Injectable TabletCommitInfo tabletCommitInfo@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
42 [style = filled, label = "TKafkaRLTaskProgress tKafkaRLTaskProgress = new TKafkaRLTaskProgress()@@@36@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
50 [style = filled, label = "KafkaTaskInfo routineLoadTaskInfo = new KafkaTaskInfo(UUID.randomUUID(),1L,\"default_cluster\",20000,partitionIdToOffset)@@@15@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
40 [style = filled, label = "Assert.assertEquals(Long.valueOf(11L),((KafkaProgress)routineLoadJob.getProgress()).getOffsetByPartition(1))@@@48@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
33 [style = filled, label = "rlTaskTxnCommitAttachment.setFilteredRows(1)@@@33@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
56 [style = filled, label = "rlTaskTxnCommitAttachment.setFilteredRows(11)@@@33@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
45 [style = filled, label = "List<RoutineLoadTaskInfo> routineLoadTaskInfoList = Deencapsulation.getField(routineLoadJob,\"routineLoadTaskInfoList\")@@@12@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
19 [style = filled, label = "Assert.assertEquals(Long.valueOf(1),Deencapsulation.getField(routineLoadJob,\"currentErrorRows\"))@@@47@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
60 [style = filled, label = "testCommitRoutineLoadTransactionWithErrorMax['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
61 [style = filled, label = "@Mocked KafkaConsumer kafkaConsumer@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
28 [style = filled, label = "idToTransactionState.put(1L,transactionState)@@@22@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
5 [style = filled, label = "transactionState.setTransactionStatus(TransactionStatus.PREPARE)@@@19@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
35 [style = filled, label = "Deencapsulation.setField(routineLoadTaskInfo,\"txnId\",1L)@@@16@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
59 [style = filled, label = "@Mocked EditLog editLog@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
22 [style = filled, label = "Deencapsulation.setField(routineLoadJob,\"state\",RoutineLoadJob.JobState.RUNNING)@@@29@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
48 [style = filled, label = "Map<Integer,Long> partitionIdToOffset = Maps.newHashMap()@@@13@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
6 [style = filled, label = "Deencapsulation.setField(routineLoadJob,\"maxErrorNum\",10)@@@23@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
13 [style = filled, label = "TabletCommitInfo tabletCommitInfo2 = new TabletCommitInfo(CatalogTestUtil.testTabletId1,CatalogTestUtil.testBackendId2)@@@5@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
23 [style = filled, label = "rlTaskTxnCommitAttachment.setKafkaRLTaskProgress(tKafkaRLTaskProgress)@@@40@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
24 [style = filled, label = "Assert.assertEquals(Long.valueOf(101),Deencapsulation.getField(routineLoadJob,\"currentTotalRows\"))@@@46@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
54 [style = filled, label = "Assert.assertEquals(Long.valueOf(0),Deencapsulation.getField(routineLoadJob,\"currentErrorRows\"))@@@47@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
32 [style = filled, label = "tKafkaRLTaskProgress.setPartitionCmtOffset(kafkaProgress)@@@39@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
29 [style = filled, label = "testCommitRoutineLoadTransaction['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
46 [style = filled, label = "oldKafkaProgressMap.put(1,0L)@@@25@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
3 [style = filled, label = "List<TabletCommitInfo> transTablets = Lists.newArrayList()@@@7@@@['1', '1', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
32->23 [style = bold, label=""];
11->46 [style = bold, label=""];
60->41 [style = bold, label=""];
50->35 [style = solid, label="routineLoadTaskInfo"];
45->48 [style = bold, label=""];
53->52 [style = dotted, label="true"];
60->57 [style = dotted, label="true"];
39->27 [style = bold, label=""];
24->58 [style = dashed, label="0"];
3->21 [style = solid, label="transTablets"];
19->40 [style = bold, label=""];
10->3 [style = bold, label=""];
10->36 [style = solid, label="tabletCommitInfo3"];
28->6 [style = bold, label=""];
20->30 [style = bold, label=""];
11->31 [style = solid, label="oldKafkaProgressMap"];
0->21 [style = bold, label=""];
12->18 [style = solid, label="routineLoadJob"];
7->1 [style = bold, label=""];
50->39 [style = solid, label="routineLoadTaskInfo"];
13->10 [style = bold, label=""];
23->4 [style = bold, label=""];
34->32 [style = solid, label="kafkaProgress"];
14->50 [style = dashed, label="0"];
12->24 [style = solid, label="routineLoadJob"];
46->25 [style = bold, label=""];
27->28 [style = solid, label="transactionState"];
29->16 [style = dotted, label="true"];
26->13 [style = bold, label=""];
37->61 [style = dashed, label="0"];
14->35 [style = bold, label=""];
9->20 [style = bold, label=""];
6->11 [style = bold, label=""];
60->59 [style = dotted, label="true"];
12->38 [style = solid, label="routineLoadJob"];
21->58 [style = bold, label=""];
22->9 [style = bold, label=""];
42->34 [style = bold, label=""];
19->54 [style = dashed, label="0"];
12->7 [style = solid, label="routineLoadJob"];
50->35 [style = bold, label=""];
44->8 [style = bold, label=""];
49->14 [style = bold, label=""];
36->12 [style = bold, label=""];
26->44 [style = solid, label="tabletCommitInfo1"];
9->4 [style = solid, label="rlTaskTxnCommitAttachment"];
30->56 [style = bold, label=""];
5->7 [style = bold, label=""];
42->23 [style = solid, label="tKafkaRLTaskProgress"];
18->15 [style = bold, label=""];
48->50 [style = solid, label="partitionIdToOffset"];
8->36 [style = bold, label=""];
54->40 [style = bold, label=""];
12->58 [style = solid, label="routineLoadJob"];
43->32 [style = bold, label=""];
4->47 [style = bold, label=""];
53->37 [style = dotted, label="true"];
53->51 [style = dotted, label="true"];
12->19 [style = solid, label="routineLoadJob"];
1->28 [style = bold, label=""];
12->22 [style = solid, label="routineLoadJob"];
4->21 [style = solid, label="txnCommitAttachment"];
29->41 [style = bold, label=""];
33->18 [style = bold, label=""];
12->6 [style = solid, label="routineLoadJob"];
25->38 [style = solid, label="oldkafkaProgress"];
30->33 [style = bold, label=""];
41->26 [style = bold, label=""];
40->55 [style = bold, label=""];
12->2 [style = solid, label="routineLoadJob"];
58->54 [style = bold, label=""];
12->45 [style = bold, label=""];
25->31 [style = bold, label=""];
15->42 [style = bold, label=""];
2->0 [style = bold, label=""];
24->19 [style = bold, label=""];
12->54 [style = solid, label="routineLoadJob"];
53->41 [style = bold, label=""];
34->43 [style = bold, label=""];
31->38 [style = bold, label=""];
29->37 [style = dotted, label="true"];
48->49 [style = bold, label=""];
29->17 [style = dotted, label="true"];
60->61 [style = dotted, label="true"];
25->31 [style = solid, label="oldkafkaProgress"];
13->8 [style = solid, label="tabletCommitInfo2"];
21->24 [style = bold, label=""];
38->22 [style = bold, label=""];
35->39 [style = bold, label=""];
14->39 [style = solid, label="routineLoadTaskInfo"];
56->18 [style = bold, label=""];
47->2 [style = bold, label=""];
27->5 [style = bold, label=""];
14->35 [style = solid, label="routineLoadTaskInfo"];
12->45 [style = solid, label="routineLoadJob"];
33->56 [style = dashed, label="0"];
48->14 [style = solid, label="partitionIdToOffset"];
49->50 [style = bold, label=""];
3->44 [style = bold, label=""];
1->0 [style = solid, label="idToTransactionState"];
}
