digraph {
7 [style = filled, label = "s_logger.info(\"Receive power on report when VM is in destroyed or expunging state. vm: \" + vm.getId() + \", state: \" + vm.getState())@@@36@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
24 [style = filled, label = "vm.getState()@@@5@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
9 [style = filled, label = "s_logger.warn(\"Unexpected VM state transition exception, race-condition?\",e)@@@11@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
1 [style = filled, label = "stateTransitTo(vm,VirtualMachine.Event.FollowAgentPowerOnReport,vm.getPowerHostId())@@@40@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
4 [style = filled, label = "s_logger.info(\"Receive power on report when VM is in error or unexpected state. vm: \" + vm.getId() + \", state: \" + vm.getState())@@@47@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
5 [style = filled, label = "_alertMgr.sendAlert(AlertManager.AlertType.ALERT_TYPE_SYNC,vm.getDataCenterId(),vm.getPodIdToDeployIn(),VM_SYNC_ALERT_SUBJECT,\"VM \" + vm.getHostName() + \"(\" + vm.getInstanceName() + \") state is sync-ed (Starting  Running) from out-of-context transition. VM network environment may need to be reset\")@@@14@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
12 [style = filled, label = "s_logger.info(\"VM \" + vm.getInstanceName() + \" is at \" + vm.getState() + \" and we received a power-on report while there is no pending jobs on it\")@@@38@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
28 [style = filled, label = "Host poweredHost = _hostDao.findById(vm.getPowerHostId())@@@4@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
30 [style = filled, label = "_alertMgr.sendAlert(AlertManager.AlertType.ALERT_TYPE_SYNC,vm.getDataCenterId(),vm.getPodIdToDeployIn(),VM_SYNC_ALERT_SUBJECT,\"VM \" + vm.getHostName() + \"(\" + vm.getInstanceName() + \") is stuck in \" + vm.getState() + \" state and its host is unreachable for too long\")@@@7@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
20 [style = filled, label = "s_logger.info(\"VM \" + vm.getInstanceName() + \" is sync-ed to at Running state according to power-on report from hypervisor\")@@@34@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
29 [style = filled, label = "scanStalledVMInTransitionStateOnDisconnectedHosts['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
17 [style = filled, label = "s_logger.warn(\"Unexpected VM state transition exception, race-condition?\",e)@@@43@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
13 [style = filled, label = "vm.getHostId() != null && vm.getHostId().longValue() != vm.getPowerHostId().longValue()@@@17@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
21 [style = filled, label = "final NoTransitionException e@@@30@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
14 [style = filled, label = "final NoTransitionException e@@@42@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
23 [style = filled, label = "stateTransitTo(vm,VirtualMachine.Event.FollowAgentPowerOnReport,vm.getPowerHostId())@@@28@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "s_logger.info(\"VM \" + vm.getInstanceName() + \" is sync-ed to at Running state according to power-on report from hypervisor\")@@@45@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
27 [style = filled, label = "handlePowerOnReportWithNoPendingJobsOnVM['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
33 [style = filled, label = "final List<Long> stuckAndUncontrollableVMs = listStalledVMInTransitionStateOnDisconnectedHosts(cutTime)@@@4@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
25 [style = filled, label = "Host host = _hostDao.findById(vm.getHostId())@@@3@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
10 [style = filled, label = "handlePowerOnReportWithNoPendingJobsOnVM['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
32 [style = filled, label = "final Date cutTime = new Date(DateUtil.currentGMTTime().getTime() - VmOpWaitInterval.value() * 1000)@@@3@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
19 [style = filled, label = "s_logger.warn(\"Unexpected VM state transition exception, race-condition?\",e)@@@31@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
6 [style = filled, label = "s_logger.info(\"VM \" + vm.getInstanceName() + \" is at \" + vm.getState() + \" and we received a power-on report while there is no pending jobs on it\")@@@26@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
31 [style = filled, label = "final VMInstanceVO vm = _vmDao.findById(vmId)@@@6@@@['0', '0', '1']", fillcolor = white, shape = ellipse image = "AAA0AAABBB3BBB"];
0 [style = filled, label = "s_logger.info(\"VM \" + vm.getInstanceName() + \" is sync-ed to at Running state according to power-on report from hypervisor\")@@@13@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
16 [style = filled, label = "stateTransitTo(vm,VirtualMachine.Event.FollowAgentPowerOnReport,vm.getPowerHostId())@@@8@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
18 [style = filled, label = "_alertMgr.sendAlert(AlertManager.AlertType.ALERT_TYPE_SYNC,vm.getDataCenterId(),vm.getPodIdToDeployIn(),VM_SYNC_ALERT_SUBJECT,\"VM \" + vm.getHostName() + \"(\" + vm.getInstanceName() + \") state is sync-ed (\" + vm.getState() + \"  Running) from out-of-context transition. VM network environment may need to be reset\")@@@33@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
15 [style = filled, label = "s_logger.info(\"VM \" + vm.getInstanceName() + \" is at \" + vm.getState() + \" and we received a power-on report while there is no pending jobs on it\")@@@6@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
3 [style = filled, label = "s_logger.info(\"Detected out of band VM migration from host \" + vm.getHostId() + \" to host \" + vm.getPowerHostId())@@@16@@@['1', '0', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB1BBB"];
2 [style = filled, label = "final VMInstanceVO vm@@@2@@@['1', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
26 [style = filled, label = "s_logger.info(String.format(\"Detected out of band VM migration from %s to %s\",host,poweredHost))@@@18@@@['0', '1', '0']", fillcolor = red, shape = ellipse image = "AAA1AAABBB2BBB"];
22 [style = filled, label = "final NoTransitionException e@@@10@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
11 [style = filled, label = "stateTransitTo(vm,VirtualMachine.Event.FollowAgentPowerOnReport,vm.getPowerHostId())@@@20@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
17->8 [style = bold, label=""];
24->6 [style = dotted, label="true"];
24->12 [style = dotted, label="true"];
24->1 [style = dotted, label="true"];
2->11 [style = solid, label="vm"];
24->12 [style = bold, label=""];
16->0 [style = bold, label=""];
19->18 [style = bold, label=""];
1->8 [style = bold, label=""];
25->28 [style = bold, label=""];
9->0 [style = bold, label=""];
3->26 [style = dashed, label="0"];
21->19 [style = bold, label=""];
13->3 [style = dotted, label="true"];
13->26 [style = dotted, label="true"];
6->23 [style = bold, label=""];
24->4 [style = dotted, label="true"];
10->24 [style = bold, label=""];
22->9 [style = bold, label=""];
3->11 [style = bold, label=""];
14->17 [style = bold, label=""];
25->26 [style = solid, label="host"];
24->13 [style = bold, label=""];
2->1 [style = solid, label="vm"];
27->2 [style = dotted, label="true"];
2->23 [style = solid, label="vm"];
15->16 [style = bold, label=""];
12->1 [style = bold, label=""];
13->11 [style = bold, label=""];
24->16 [style = dotted, label="true"];
26->11 [style = bold, label=""];
32->33 [style = bold, label=""];
24->11 [style = dotted, label="true"];
14->17 [style = dotted, label="true"];
18->20 [style = bold, label=""];
24->4 [style = bold, label=""];
32->33 [style = solid, label="cutTime"];
24->23 [style = dotted, label="true"];
13->3 [style = bold, label=""];
10->2 [style = dotted, label="true"];
13->26 [style = bold, label=""];
30->31 [style = bold, label=""];
29->32 [style = bold, label=""];
24->20 [style = dotted, label="true"];
24->0 [style = dotted, label="true"];
24->15 [style = dotted, label="true"];
21->19 [style = dotted, label="true"];
31->30 [style = bold, label=""];
28->24 [style = bold, label=""];
33->31 [style = bold, label=""];
24->8 [style = dotted, label="true"];
22->9 [style = dotted, label="true"];
2->16 [style = solid, label="vm"];
24->6 [style = bold, label=""];
24->7 [style = bold, label=""];
27->25 [style = bold, label=""];
24->7 [style = dotted, label="true"];
24->5 [style = dotted, label="true"];
23->18 [style = bold, label=""];
24->18 [style = dotted, label="true"];
0->5 [style = bold, label=""];
28->26 [style = solid, label="poweredHost"];
24->15 [style = bold, label=""];
24->13 [style = dotted, label="true"];
}
