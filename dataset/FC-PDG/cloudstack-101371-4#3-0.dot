digraph {
27 [style = filled, label = "throw new InvalidParameterValueException(\"Unable to find volume with ID: \" + volumeId)@@@16@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
50 [style = filled, label = "throw new InvalidParameterValueException(\"Please provide either a volume id, or a tuple(device id, instance id)\")@@@5@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
12 [style = filled, label = "s_logger.isInfoEnabled()@@@49@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
54 [style = filled, label = "Account caller = CallContext.current().getCallingAccount()@@@3@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
39 [style = filled, label = "java.util.concurrent.ExecutionException e@@@74@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
14 [style = filled, label = "Long volumeId = cmmd.getId()@@@7@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
65 [style = filled, label = "List<VolumeVO> volumes@@@2@@@['0', '0', '1']", fillcolor = tomato, shape = box image = "AAA0AAABBB3BBB"];
42 [style = filled, label = "throw new RuntimeException(\"Unexpected exception\",(Throwable)jobResult)@@@86@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
29 [style = filled, label = "jobContext.isJobDispatchedBy(VmWorkConstants.VM_WORK_JOB_DISPATCHER)@@@55@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
43 [style = filled, label = "throw new RuntimeException(\"Operation is interrupted\",e)@@@72@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
2 [style = filled, label = "InterruptedException e@@@71@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
16 [style = filled, label = "VmWorkJobVO placeHolder = null@@@56@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
44 [style = filled, label = "placeHolder = createPlaceHolderWork(vmId)@@@57@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
53 [style = filled, label = "Volume vol = null@@@67@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
37 [style = filled, label = "outcome.get()@@@69@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
0 [style = filled, label = "volume = _volsDao.findByInstanceAndDeviceId(cmmd.getVirtualMachineId(),cmmd.getDeviceId()).get(0)@@@13@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
48 [style = filled, label = "detachVolumeFromVM['1', '0', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB1BBB"];
26 [style = filled, label = "VolumeVO volume = null@@@8@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
21 [style = filled, label = "(cmmd.getId() == null && cmmd.getDeviceId() == null && cmmd.getVirtualMachineId() == null) || (cmmd.getId() != null && (cmmd.getDeviceId() != null || cmmd.getVirtualMachineId() != null)) || (cmmd.getId() == null && (cmmd.getDeviceId() == null || cmmd.getVirtualMachineId() == null))@@@4@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
47 [style = filled, label = "throw new InvalidParameterValueException(\"Please specify a VM that is either running or stopped.\")@@@31@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
38 [style = filled, label = "asyncExecutionContext != null@@@47@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
51 [style = filled, label = "throw new InvalidParameterValueException(\"Unable to detach volume, please specify a VM that does not have VM snapshots\")@@@41@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
8 [style = filled, label = "_jobMgr.updateAsyncJobAttachment(job.getId(),\"Volume\",volumeId)@@@52@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
30 [style = filled, label = "vol = _volsDao.findById((Long)jobResult)@@@89@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
62 [style = filled, label = "throw new InvalidParameterValueException(\"Please specify volume of type \" + Volume.Type.DATADISK.toString() + \" or \" + Volume.Type.ROOT.toString())@@@5@@@['0', '0', '1']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB3BBB"];
31 [style = filled, label = "vmSnapshots.size() > 0@@@40@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
59 [style = filled, label = "vm.getBackupOfferingId() != null || vm.getBackupVolumeList().size() > 0@@@43@@@['0', '1', '0']", fillcolor = white, shape = diamond image = "AAA1AAABBB2BBB"];
25 [style = filled, label = "throw (RuntimeException)jobResult@@@83@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
20 [style = filled, label = "volume.getVolumeType() == Volume.Type.ROOT@@@36@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
1 [style = filled, label = "volumeId != null@@@9@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
24 [style = filled, label = "throw new InvalidParameterValueException(\"The specified volume is not attached to a VM.\")@@@27@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
34 [style = filled, label = "AsyncJobExecutionContext asyncExecutionContext = AsyncJobExecutionContext.getCurrentExecutionContext()@@@46@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
19 [style = filled, label = "volume = _volsDao.findById(volumeId)@@@10@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
33 [style = filled, label = "UserVmVO vm = _userVmDao.findById(vmId)@@@29@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
7 [style = filled, label = "vm.getState() != State.Running && vm.getState() != State.Stopped && vm.getState() != State.Destroyed@@@30@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
40 [style = filled, label = "Long vmId = null@@@18@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
57 [style = filled, label = "DetachVolumeCmd cmmd@@@2@@@['1', '1', '0']", fillcolor = tomato, shape = box image = "AAA0AAABBB1BBB"];
32 [style = filled, label = "jobResult instanceof RuntimeException@@@82@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
22 [style = filled, label = "AsyncJob job = asyncExecutionContext.getJob()@@@48@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
41 [style = filled, label = "AsyncJobExecutionContext jobContext = AsyncJobExecutionContext.getCurrentExecutionContext()@@@54@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
56 [style = filled, label = "cmmd.getVirtualMachineId() == null@@@19@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
13 [style = filled, label = "{_workJobDao.expunge(placeHolder.getId())}@@@61@@@['1', '1', '0']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB1BBB"];
63 [style = filled, label = "!(volume.getVolumeType() == Volume.Type.ROOT || volume.getVolumeType() == Volume.Type.DATADISK)@@@4@@@['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
49 [style = filled, label = "jobResult instanceof Long@@@88@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
18 [style = filled, label = "!(volume.getVolumeType() == Volume.Type.ROOT || volume.getVolumeType() == Volume.Type.DATADISK)@@@33@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
9 [style = filled, label = "throw new RuntimeException(\"Execution excetion\",e)@@@75@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
61 [style = filled, label = "detachVolumeFromVM['0', '1', '0']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB2BBB"];
46 [style = filled, label = "jobResult instanceof Throwable@@@85@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
58 [style = filled, label = "validateRootVolumeDetachAttach(volume,vm)@@@37@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
45 [style = filled, label = "vmId = volume.getInstanceId()@@@20@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
64 [style = filled, label = "validateVolumes['0', '0', '1']", fillcolor = lightgray, shape = diamond image = "AAA0AAABBB3BBB"];
11 [style = filled, label = "vmId = cmmd.getVirtualMachineId()@@@23@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
10 [style = filled, label = "Outcome<Volume> outcome = detachVolumeFromVmThroughJobQueue(vmId,volumeId)@@@66@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
52 [style = filled, label = "s_logger.info(\"Trying to attaching volume \" + volumeId + \"to vm instance:\" + vm.getId() + \", update async job-\" + job.getId() + \" progress status\")@@@50@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
23 [style = filled, label = "volume == null@@@15@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
36 [style = filled, label = "throw new InvalidParameterValueException(\"Please specify volume of type \" + Volume.Type.DATADISK.toString() + \" or \" + Volume.Type.ROOT.toString())@@@34@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
55 [style = filled, label = "throw (ConcurrentOperationException)jobResult@@@80@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
17 [style = filled, label = "jobResult instanceof ConcurrentOperationException@@@79@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
6 [style = filled, label = "jobResult != null@@@78@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
60 [style = filled, label = "throw new InvalidParameterValueException(\"Unable to detach volume, cannot detach volume from a VM that has backups. First remove the VM from the backup offering.\")@@@44@@@['0', '1', '0']", fillcolor = white, shape = ellipse image = "AAA1AAABBB2BBB"];
5 [style = filled, label = "vmId == null@@@26@@@['1', '1', '0']", fillcolor = white, shape = diamond image = "AAA0AAABBB1BBB"];
15 [style = filled, label = "_accountMgr.checkAccess(caller,null,true,volume)@@@25@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
28 [style = filled, label = "return orchestrateDetachVolumeFromVM(vmId,volumeId)@@@59@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
35 [style = filled, label = "List<VMSnapshotVO> vmSnapshots = _vmSnapshotDao.findByVm(vmId)@@@39@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
4 [style = filled, label = "Object jobResult = _jobMgr.unmarshallResultObject(outcome.getJob())@@@77@@@['1', '1', '0']", fillcolor = white, shape = ellipse image = "AAA0AAABBB1BBB"];
3 [style = filled, label = "return vol@@@92@@@['1', '1', '0']", fillcolor = lightgray, shape = ellipse image = "AAA0AAABBB1BBB"];
49->30 [style = bold, label=""];
28->13 [style = bold, label=""];
56->45 [style = bold, label=""];
4->6 [style = bold, label=""];
43->4 [style = bold, label=""];
54->21 [style = bold, label=""];
25->3 [style = bold, label=""];
32->46 [style = dotted, label="false"];
18->20 [style = bold, label=""];
4->55 [style = solid, label="jobResult"];
14->1 [style = solid, label="volumeId"];
24->33 [style = bold, label=""];
29->6 [style = dotted, label="false"];
36->20 [style = bold, label=""];
11->5 [style = solid, label="vmId"];
38->41 [style = bold, label=""];
19->58 [style = solid, label="volume"];
30->3 [style = solid, label="vol"];
19->23 [style = bold, label=""];
44->28 [style = bold, label=""];
17->55 [style = dotted, label="true"];
0->23 [style = bold, label=""];
34->38 [style = bold, label=""];
49->3 [style = bold, label=""];
51->59 [style = bold, label=""];
4->6 [style = solid, label="jobResult"];
42->3 [style = bold, label=""];
11->33 [style = solid, label="vmId"];
49->30 [style = dotted, label="true"];
14->28 [style = solid, label="volumeId"];
37->4 [style = bold, label=""];
56->45 [style = dotted, label="true"];
40->56 [style = bold, label=""];
61->57 [style = dotted, label="true"];
63->62 [style = bold, label=""];
50->14 [style = bold, label=""];
5->33 [style = bold, label=""];
45->33 [style = solid, label="vmId"];
38->8 [style = dotted, label="true"];
29->28 [style = dotted, label="true"];
11->10 [style = solid, label="vmId"];
4->30 [style = solid, label="jobResult"];
29->3 [style = dotted, label="false"];
31->34 [style = bold, label=""];
64->63 [style = bold, label=""];
7->47 [style = bold, label=""];
45->15 [style = bold, label=""];
23->27 [style = bold, label=""];
2->43 [style = dotted, label="true"];
45->28 [style = solid, label="vmId"];
59->34 [style = bold, label=""];
14->27 [style = solid, label="volumeId"];
29->16 [style = dotted, label="true"];
33->58 [style = solid, label="vm"];
63->62 [style = dotted, label="true"];
48->54 [style = bold, label=""];
7->47 [style = dotted, label="true"];
56->11 [style = dotted, label="false"];
6->17 [style = dotted, label="true"];
31->51 [style = bold, label=""];
17->32 [style = bold, label=""];
4->32 [style = solid, label="jobResult"];
20->35 [style = bold, label=""];
0->58 [style = solid, label="volume"];
5->24 [style = bold, label=""];
54->15 [style = solid, label="caller"];
26->1 [style = bold, label=""];
17->32 [style = dotted, label="false"];
20->58 [style = dotted, label="true"];
15->5 [style = bold, label=""];
1->19 [style = dotted, label="true"];
29->10 [style = bold, label=""];
46->42 [style = dotted, label="true"];
52->8 [style = bold, label=""];
58->35 [style = bold, label=""];
1->0 [style = bold, label=""];
17->55 [style = bold, label=""];
19->15 [style = solid, label="volume"];
8->41 [style = bold, label=""];
21->14 [style = bold, label=""];
2->43 [style = bold, label=""];
14->52 [style = solid, label="volumeId"];
53->3 [style = solid, label="vol"];
11->35 [style = solid, label="vmId"];
64->65 [style = dotted, label="true"];
9->4 [style = bold, label=""];
4->42 [style = solid, label="jobResult"];
35->31 [style = bold, label=""];
21->50 [style = bold, label=""];
7->18 [style = bold, label=""];
32->25 [style = dotted, label="true"];
1->0 [style = dotted, label="false"];
59->60 [style = dotted, label="true"];
29->44 [style = dotted, label="true"];
51->34 [style = bold, label=""];
33->7 [style = bold, label=""];
11->15 [style = bold, label=""];
21->50 [style = dotted, label="true"];
0->23 [style = solid, label="volume"];
38->22 [style = dotted, label="true"];
23->27 [style = dotted, label="true"];
32->46 [style = bold, label=""];
29->16 [style = bold, label=""];
32->25 [style = bold, label=""];
29->4 [style = dotted, label="false"];
29->10 [style = dotted, label="false"];
5->24 [style = dotted, label="true"];
6->3 [style = bold, label=""];
48->57 [style = dotted, label="true"];
39->9 [style = bold, label=""];
4->46 [style = solid, label="jobResult"];
23->40 [style = bold, label=""];
34->38 [style = solid, label="asyncExecutionContext"];
22->12 [style = bold, label=""];
56->11 [style = bold, label=""];
12->8 [style = bold, label=""];
39->9 [style = dotted, label="true"];
18->36 [style = dotted, label="true"];
12->52 [style = dotted, label="true"];
29->37 [style = dotted, label="true"];
46->49 [style = bold, label=""];
47->18 [style = bold, label=""];
53->37 [style = bold, label=""];
4->17 [style = solid, label="jobResult"];
4->25 [style = solid, label="jobResult"];
59->60 [style = bold, label=""];
31->59 [style = bold, label=""];
14->10 [style = solid, label="volumeId"];
46->49 [style = dotted, label="false"];
0->15 [style = solid, label="volume"];
6->17 [style = bold, label=""];
20->58 [style = bold, label=""];
46->42 [style = bold, label=""];
38->22 [style = bold, label=""];
14->19 [style = solid, label="volumeId"];
14->26 [style = bold, label=""];
19->23 [style = solid, label="volume"];
45->10 [style = solid, label="vmId"];
11->28 [style = solid, label="vmId"];
27->40 [style = bold, label=""];
16->44 [style = bold, label=""];
10->53 [style = bold, label=""];
45->35 [style = solid, label="vmId"];
14->8 [style = solid, label="volumeId"];
41->29 [style = bold, label=""];
30->3 [style = bold, label=""];
60->34 [style = bold, label=""];
4->49 [style = solid, label="jobResult"];
61->54 [style = bold, label=""];
1->19 [style = bold, label=""];
55->3 [style = bold, label=""];
11->44 [style = solid, label="vmId"];
18->36 [style = bold, label=""];
45->44 [style = solid, label="vmId"];
38->12 [style = dotted, label="true"];
29->53 [style = dotted, label="false"];
31->51 [style = dotted, label="true"];
45->5 [style = solid, label="vmId"];
12->52 [style = bold, label=""];
62->63 [style = bold, label=""];
}
